geom_point(aes(color = mean)) +
# geom_path(data  = fortify(map), aes(long, lat, group = group)) +
geom_sf(data = map, inherit.aes = FALSE, fill = NULL) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean)) +
# geom_path(data  = fortify(map), aes(long, lat, group = group)) +
geom_sf(data = map, inherit.aes = FALSE, fill = FALSE) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean)) +
# geom_path(data  = fortify(map), aes(long, lat, group = group)) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_divergent() +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean < 260]
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_divergent() +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_brewer(type = "seq", palette = "YlOrRd") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_distiller(type = "seq", palette = "YlOrRd") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_distiller(type = "seq", palette = "YlOrRd", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_distiller(type = "seq", palette = "YlOrRd", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_distiller(type = "seq", palette = "YlGnBu", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_distiller(type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = mean - 273.15)) +
scale_color_distiller(name = "Mean", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = spread)) +
scale_color_distiller(name = "Spread", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260 & spread < 6] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = spread)) +
scale_color_distiller(name = "Spread", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum %>% ggplot(aes(spread)) + geom_density()
ana_T2_sum[mean > 260 & spread < 2.5] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = spread)) +
scale_color_distiller(name = "Spread", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum[mean > 260 & spread < 2.5] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = spread)) +
scale_color_distiller(name = "Spread", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time)
ana_T2_sum <- ana_T2[, .("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_distiller(name = "Spread", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2_sum <- ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_distiller(name = "Spread", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2_sum <- ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_grid(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[, abs(anom) < 5] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_grid(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[, abs(anom) < 5] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_grid(date.time ~ ens) +
theme(legend.position = "bottom")
map <- rnaturalearth::ne_states(country = c("argentina", "Brazil", "Chile", "Uruguay", "Paraguay", "Bolivia"), returnclass = "sf")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[, abs(anom) < 5]
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[abs(anom) < 5] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_grid(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(anom)) +
geom_density()
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[abs(anom) > 3]
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[abs(anom) > 3] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_grid(date.time ~ ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[abs(anom) > 3] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[abs(anom) > 3] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ens) +
theme(legend.position = "bottom")
ana_T2[, c("mean", "spread") := .(mean(var), sd(var)), by = .(lon, lat, date.time)] %>%
.[, anom := var - mean] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
.[abs(anom) > 3] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = anom)) +
scale_color_divergent(name = "Anomalia") +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ens, ncol = 5) +
theme(legend.position = "bottom")
obs[, rmsi := sqrt(mean(obs.guess^2)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
obs[, rmsi := sqrt(mean(obs.guess^2)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
obs[, rmsi := sqrt(mean(obs.guess^2)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
obs[, rmsi = sqrt(mean(obs.guess^2)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
str(obs)
obs[, .(rmsi = sqrt(mean(obs.guess^2))), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
obs[, .(rmsi = sqrt(mean(obs.guess^2))), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
obs[, .(rmsi = sqrt(mean(obs.guess^2))), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
a <- obs[, .(rmsi = sqrt(mean(obs.guess^2))), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
View(a)
range(a$rmsi)
ggplot(a, aes(rmsi)) +
geom_density()
a <- obs[, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
ggplot(a, aes(rmsi)) +
geom_density()
ggplot(a, aes(rmsi)) +
geom_density() + scale_x_log10()
ggplot(obs, aes(obs.guess)) +
geom_density() +
scale_x_log10()
ggplot(obs, aes(obs.guess)) +
geom_density() +
NULL
obs[obs.guess <75000]
files <- Sys.glob("E1/diagfiles/asim*")
obs <- lapply(files, function(f) {
date_time <- ymd_hms(substr(basename(f), 11, 24))
ens <- substr(basename(f), 29, 31)
fread(f, na.strings = c("1e+10", "10000000000.00", "-99999.90", "-10000.0")) %>%
.[, date.time := date_time] %>%
.[, ens := ens] %>%
.[]
}) %>%
rbindlist() %>%
.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
ggplot(obs, aes(obs.guess)) +
geom_density()
files <- Sys.glob("E1/diagfiles/asim*")
obs <- lapply(files, function(f) {
date_time <- ymd_hms(substr(basename(f), 11, 24))
ens <- substr(basename(f), 29, 31)
fread(f, na.strings = c("1e+10", "10000000000.00", "-99999.90", "-100000.0")) %>%
.[, date.time := date_time] %>%
.[, ens := ens] %>%
.[]
}) %>%
rbindlist() %>%
.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
ggplot(obs, aes(obs.guess)) +
geom_density()
files <- Sys.glob("E1/diagfiles/asim*")
obs <- lapply(files, function(f) {
date_time <- ymd_hms(substr(basename(f), 11, 24))
ens <- substr(basename(f), 29, 31)
fread(f, na.strings = c("1e+10", "10000000000.00", "-99999.90", "-100000.00")) %>%
.[, date.time := date_time] %>%
.[, ens := ens] %>%
.[]
}) %>%
rbindlist() %>%
.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
ggplot(obs, aes(obs.guess)) +
geom_density()
View(obs)
files <- Sys.glob("E1/diagfiles/asim*")
obs <- lapply(files, function(f) {
date_time <- ymd_hms(substr(basename(f), 11, 24))
ens <- substr(basename(f), 29, 31)
fread(f, na.strings = c("0.100E+11", "10000000000.00", "-99999.90", "-100000.00")) %>%
.[, date.time := date_time] %>%
.[, ens := ens] %>%
.[]
}) %>%
rbindlist() %>%
.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
ggplot(obs, aes(obs.guess)) +
geom_density()
obs[obs.guess < -90000]
files <- Sys.glob("E1/diagfiles/asim*")
obs <- lapply(files, function(f) {
date_time <- ymd_hms(substr(basename(f), 11, 24))
ens <- substr(basename(f), 29, 31)
fread(f, na.strings = c("0.100E+11", "-0.100E+06", "-99999.90", "-100000.00")) %>%
.[, date.time := date_time] %>%
.[, ens := ens] %>%
.[]
}) %>%
rbindlist() %>%
.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
ggplot(obs, aes(obs.guess)) +
geom_density()
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq", palette = "YlGnBu", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
a <- obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)]
View(a)
range(a$rmsi)
ggplot(a, aes(rmsi)) +
geom_density()
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq",
palette = "YlGnBu", direction = -1,
lims(0, 50)) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq",
palette = "YlGnBu", direction = -1,
limits = c(0, 50)) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(lon, lat)) +
# geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq",
palette = "YlGnBu", direction = -1,
limits = c(0, 50)) +
# coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
obs[usage.flag == 1, .(rmsi = sqrt(sum(obs.guess)^2/.N)), by = .(lon, lat, date.time)] %>%
copy() %>%
.[, date.time := factor(date.time)] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = rmsi)) +
scale_color_distiller(name = "RMSI", type = "seq",
palette = "YlGnBu", direction = -1,
limits = c(0, 50)) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
facet_wrap(~ date.time) +
theme(legend.position = "bottom")
