.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
obs[usage.flag == 1 & ens == "001" & rerr < 5e9] %>%
ggplot(aes(obs.guess)) +
geom_density(aes(color = var)) +
geom_rug() +
facet_wrap(~factor(var), scales = "free") +
theme(legend.position = "none") +
obs[usage.flag == 1 & rerr < 5e9] %>%
ggplot(aes(obs.guess, rerr)) +
geom_point(alpha = 0.05, size = 0.5) +
facet_wrap(~var, scales = "free")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(metR)
library(data.table)
library(dplyr)
library(lubridate)
library(patchwork)
map <- rnaturalearth::ne_states(country = c("argentina", "Brazil", "Chile", "Uruguay", "Paraguay", "Bolivia"), returnclass = "sf")
proj <- paste0("+proj=lcc +lat_1=-30.966 +lat_2=-30.966 +lat_0=-30.966 +lon_0=-63.567",
" +x_0=0 +y_0=0 +ellps=GRS80 +datum=NAD83 +units=m +no_defs")
hgt <- ReadNetCDF("E1/wrfinput_d01", vars = c("HGT"))
GlanceNetCDF("E1/wrfinput_d01")
hgt <- ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG"))
str(hgt)
hgt <- ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lon", "lat"))
hgt <- ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lon", "lat")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lon", "lat")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_brewer(type = "seq", palette = "YlOrBr")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_brewer(type = "seq", palette = "YlOrBr")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = -1)
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = 1)
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE)
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NULL) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE, fill = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlOrBr", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "BrBG", direction = 1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "BrBG", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "YlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52))
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitude", y = "Latitude")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-41, -20), xlim = c(-75, -52)) +
labs(x = "Longitude", y = "Latitude")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-41, -20), xlim = c(-75, -53)) +
labs(x = "Longitude", y = "Latitude")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-41, -20), xlim = c(-75, -52.5)) +
labs(x = "Longitude", y = "Latitude")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-41, -20), xlim = c(-75, -52.5)) +
labs(x = "Longitude", y = "Latitude") +
theme_minimal()
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-41, -20), xlim = c(-75, -52.5)) +
labs(x = "Longitude", y = "Latitude") +
theme_minimal() +
theme(legend.position = "bottom")
ReadNetCDF("E1/wrfinput_d01", vars = c("HGT", "XLAT", "XLONG")) %>%
setnames(c("HGT", "XLAT", "XLONG"), c("hgt", "lat", "lon")) %>%
ggplot(aes(lon, lat)) +
geom_point(aes(color = hgt)) +
scale_color_distiller(name = "Topography", type = "seq", palette = "RdYlGn", direction = -1) +
geom_sf(data = map, inherit.aes = FALSE, fill = NA) +
coord_sf(ylim = c(-41, -20), xlim = c(-75, -52.5)) +
labs(x = "Longitude", y = "Latitude") +
theme_minimal()
files <- Sys.glob("E1/diagfiles/asim*")
obs <- lapply(files, function(f) {
date_time <- ymd_hms(substr(basename(f), 11, 24))
ens <- substr(basename(f), 29, 31)
fread(f, na.strings = c("0.100E+11", "-0.100E+06", "-99999.90", "-100000.00")) %>%
.[, date.time := date_time] %>%
.[, ens := ens] %>%
.[]
}) %>%
rbindlist() %>%
.[, c("V2", "V4") := NULL]
colnames(obs) <- c("var", "stationID", "type", "dhr", "lat", "lon", "pressure", "usage.flag", "obs", "obs.guess", "obs2", "obs.guess2", "rerr", "date.time", "ens")
obs[usage.flag == 1 & var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(fill = N, size = N), shape = 21) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(title = "Observaciones en prepbufr nivel 2", x = "lon") +
theme(legend.position = "bottom")
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(shape = 21) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(title = "Observaciones en prepbufr nivel 2", x = "lon") +
theme(legend.position = "bottom")
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)]
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
uniqueN(by = stationID)
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
uniqueN(by = stationID)
uniqueN(by = c("stationID")
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
uniqueN(by = c("stationID"))
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID"))
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(shape = 21) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme(legend.position = "bottom")
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(shape = 21) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID"))
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_size_area(max_size = 3, guide = "none") +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_viridis_d()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_viridis_d() +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_distiller() +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_brewer() +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_manual() +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_manual(values = c("TRUE" = "orange", "FALSE" = "green")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "orange", "FALSE" = "green")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.5, aes(color = !is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = !is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID")) %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
obs[var == "t" & ens == "001" & date.time == date.time[1], .N, by = .(stationID, lon, lat)] %>%
unique(by = c("stationID"))
library(tidyverse)
str_detect(obs$stationID, "SMN")
obs[str_detect(obs$stationID, "SMN")]
obs[str_detect(stationID, "SMN")]
unique(obs, by = c("stationID")) %>%
.[str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7")) +
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official", "Non-official"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(alpha = 0.7, color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official", "Non-official"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(aes(alpha = 0.8, color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official", "Non-official"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.9, aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official", "Non-official"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.8, aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official", "Non-official"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal()
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.8, aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official", "Non-official"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal() +
theme(legend.position = "bottom")
obs[ens == 1 & date.time == date.time[1], .N, by = .(stationID)]
obs[ens == 1 & date.time == date.time[1], .N]
obs[ens == 1 & date.time == date.time[1]]
obs[ens == 1 & date.time == unique(date.time)[1]]
obs[ens == "001" & date.time == unique(date.time)[1]]
obs[ens == "001" & date.time == unique(date.time)[1], .N]
obs[ens == "001" & date.time == unique(date.time)[1]] %>%
.[, station := ifelse(is.na(as.numeric(stationID)), "non-official", "offitial")]
obs[ens == "001" & date.time == unique(date.time)[1]] %>%
.[, station := ifelse(is.na(as.numeric(stationID)), "non-official", "offitial")] %>%
.[, .N, by = .(station)]
obs[ens == "001" & date.time == unique(date.time)[1]] %>%
unique(by = c("stationID")) %>%
.[, station := ifelse(is.na(as.numeric(stationID)), "non-official", "offitial")] %>%
.[, .N, by = .(station)]
obs[ens == "001" & date.time == unique(date.time)[1]] %>%
# unique(by = c("stationID")) %>%
.[, station := ifelse(is.na(as.numeric(stationID)), "non-official", "offitial")] %>%
.[, .N, by = .(station)]
4996+463
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.8, aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official (116)", "Non-official (409)"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal() +
theme(legend.position = "bottom")
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.8, aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official (N = 116)", "Non-official (N = 409)"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal() +
theme(legend.position = "bottom")
unique(obs, by = c("stationID")) %>%
.[!str_detect(stationID, "SMN")] %>%
ggplot(aes(ConvertLongitude(lon), lat)) +
geom_sf(data = map, inherit.aes = FALSE) +
geom_point(alpha = 0.8, aes(color = is.na(as.numeric(stationID)))) +
scale_color_manual(name =  NULL, values = c("TRUE" = "#FD8002", "FALSE" = "#367DB7"),
breaks = c("FALSE", "TRUE"),
labels = c("Official (N = 116)", "Non-official (N = 409)"))+
coord_sf(ylim = c(-42, -20), xlim = c(-75, -52)) +
labs(x = "Longitud", y = "Latitud") +
theme_minimal(base_size = 18) +
theme(legend.position = "bottom")
remotes::install_github("eliocamp/mountr")
